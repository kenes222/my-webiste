{% extends 'give/base.html' %}

{% block content %}
<h1>Search</h1>
<form method="get">
    {{ form.as_p }}
    <button type="submit" class="btn btn-primary">Search</button>
</form>

{% if query %}
    <h2>Results for "{{ query }}"</h2>
    {% if search_type == "user" %}
        {% if users %}
            <h3>Users</h3>
            <ul>
            {% for user in users %}
                <li>
                    <a href="{% url 'portfolio2' user.user.id %}">{{ user.username }}</a>
                </li>
            {% endfor %}
            </ul>
        {% else %}
            <p>No users found with that username.</p>
        {% endif %}
    {% else %}
        {% if posts %}
            <h3>Posts</h3>
            <ul>
            {% for post in posts %}
                <li>
                    <a href="{% url 'view_post' post.id %}">{{ post.title }}</a>
                </li>
            {% endfor %}
            </ul>
        {% else %}
            <p>No posts found with that title.</p>
        {% endif %}
        
        {% if categories %}
            <h3>Categories</h3>
            <ul>
            {% for category in categories %}
                <li>
                    <h3>{{ category.name }}</h3>
                    <ul>
                        {% for post in category.post_set.all %}
                        <li>
                            <a href="{% url 'view_post' post.id %}">{{ post.title }}</a>
                        </li>
                        {% endfor %}
                    </ul>
                </li>
            {% endfor %}
            </ul>
        {% else %}
            <p>No categories found with that name.</p>
        {% endif %}
        
        {% if users %}
            <h3>Users</h3>
            <ul>
            {% for user in users %}
                <li>
                    <a href="{% url 'portfolio2' user.user.id %}">{{ user.username }}</a>
                </li>
            {% endfor %}
            </ul>
        {% else %}
            <p>No users found with that username.</p>
        {% endif %}
    {% endif %}
{% endif %}

<a href="{% url 'dashboard' %}" class="btn btn-secondary">Back to Dashboard</a>
{% endblock %}
